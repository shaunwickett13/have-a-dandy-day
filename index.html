<!DOCTYPE html>
<html lang="en">
<head>
    <title>Have A Dandy Day!</title>

	<meta http-equiv="content-type" content="text/html;" charset="UTF-8" />
    <meta name="description" content="Wherever you are... whoever you are... have a dandy day!" />
    <meta name="keywords" content="dandy, day, positivity, greetings, well wishes" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=no" />

    <meta name="theme-color" content="black" />

    <meta property="og:title" content="Have A Dandy Day!" />
    <meta property="og:url" content="https://haveadandyday.com" />
    <meta property="og:description" content="Wherever you are... whoever you are... have a dandy day!">
    <meta property="og:type" content="website" />
    <meta property="og:image" content="https://haveadandyday.com/image/share.png" />
    <meta property="og:image:alt" content="A man's head peeks out the bottom of the frame and there is text above him saying 'Have A Dandy Day!'" />
    <meta property="og:image:type" content="image/png" />
    <meta property="og:image:width" content="1250" />
    <meta property="og:image:height" content="1250" />

    <link rel="apple-touch-icon" sizes="180x180" href="image/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="image/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="image/favicon-16x16.png">
    <link rel="manifest" href="site.webmanifest">

    <link rel="stylesheet" href="https://github.hubspot.com/odometer/themes/odometer-theme-default.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Comfortaa">
    <link rel="stylesheet" type="text/css" href="style.css" media="screen" />

    <script src="https://github.hubspot.com/odometer/odometer.js"></script>
    <script>
        (() => {
            class QuoteProvider {
                static #quotes = [
                    "Keep your chin up, your spirit bright, and your outfit dazzling. That's the recipe for a dandy day! If you want the recipe for meatless chili, look elsewhere!",
                    "In Dandyland, we don't have bad days, just different shades of dandy! Except for the time the Dandyland volcano erupted. That was a bad day!",
                    "Remember, wherever you are, you're always just a hop, skip, and a jolly jump away from a dandy day! Unless you're on the edge of a cliff. Then you're a hop, skip, and a jolly jump away from a dreadful drop!",
                    "If your day feels as flat as a pancake, just add some syrup of silliness and a dollop of dandy! I never liked pancakes! Waffles are much better!",
                    "Every morning is a chance to make the world a more delightful and dandy place! Every night is another chance to slumber! Those are facts!",
                    "My grandmother always said, \"Don't climb trees while drinking spoiled milk.\" She had a lot of interesting advice! Rest in peace!",
                    "I'm on a diet, I've decided to cut down on negativity and fill my plate with dandy! I usually have seconds, thirds, and fourths!",
                    "Ever find yourself up the creek without a paddle? Build a sail from your dreams and let the winds of whimsy guide you! Watch out for creek sharks!",
                    "Am I a mad man, or just the pinnacle of dandy? The jury is still out! And no one knows when they'll be back!",
                    "Some people say my moustache is fake. It's hairy and real! Trust me!",
                    "A racoon once witnessed me practicing my dandy dance. It wailed like a banshee and scurried off never to be seen again! I think it had rabies!",
                    "They said, \"Dress for the job you want.\" So I put on my bowling hat and rainbow blazer and started dancing! No one would hire me! Oh well!",
                    "A person once asked me if I was a magician. I told them I was Dandy Dan and then I blasted them with my confetti cannon. It was a classic prank!",
                    "If life gives you lemons, squeeze them into the eyes of your naysayers. Just kidding! Do not do that!",
                    "This morning I bashed my toe on the wall four times in a row. I was swearing like a sailor! Sorry!",
                    "Sometimes the wheels don't come off the bus and you take a joyride down Dandy Lane instead. Hold on to your britches! It's going to be a bumpy ride!",
                    "I have heard people say, \"You are a strange man Dandy Dan.\" To that I say, \"The people have spoken!\"",
                    "Some say I'm off the wall but I say, \"Perfect! It's much more fun to bounce around!\" One time, I bounced too high and smashed my noggin on the ceiling! There was brain damage for sure!",
                ]

                constructor() {
                    this.quoteIndex = 0;
                    this.quotes = QuoteProvider.#quotes
                        .map(value => ({value, sort: Math.random()}))
                        .sort((a, b) => a.sort - b.sort)
                        .map(({value}) => value)
                }

                increment() {
                    if (this.quoteIndex === this.quotes.length - 1) {
                        this.quoteIndex = 0
                    } else {
                        this.quoteIndex++
                    }
                }

                get() {
                    return this.quotes[this.quoteIndex]
                }

                getAndIncrement() {
                    const quote = this.get();
                    this.increment();
                    return quote;
                }
            }

            class DandyDayApi {
                static #apiDomainName = "https://api.haveadandyday.com"
                incrementButtonCount() {
                    try {
                        return fetch(`${DandyDayApi.#apiDomainName}/statistics/button`, { method: 'POST' })
                    } catch (e) {
                        console.error(`Failed to increment button counter: ${e}`)
                        return Promise.reject(e)
                    }
                }

                getButtonCount() {
                    try {
                        return fetch(`${DandyDayApi.#apiDomainName}/statistics/button`)
                            .then(response => response.json())
                            .then(response => JSON.parse(response.output).data.map(d => d.count).reduce((x, a) => x + a, 0))
                    } catch (e) {
                        console.error(`Failed to get button count: ${e}`)
                        return Promise.reject(e)
                    }
                }
            }

            const quoteProvider = new QuoteProvider()
            const api = new DandyDayApi()

            const focusSchedule = [
                [3.5, "have"],
                [4.0, "a"],
                [4.5, "dan"],
                [4.75, "dy"],
                [5.0, "day"],
                [10.0, "have"],
                [10.5, "a"],
                [11, "dan"],
                [11.25, "dy"],
                [11.5, "day"],
                [23.0, "have"],
                [23.5, "a"],
                [24, "dan"],
                [24.25, "dy"],
                [24.5, "day"],
                [24.75, "have"],
                [25.25, "a"],
                [25.75, "dan"],
                [26, "dy"],
                [26.25, "day"],
            ]
            const sharePayload = {
                title: "Have A Dandy Day!",
                url: "https://haveadandyday.com"
            }
            const isLocalhost = window.location.href.includes("localhost")
            const isShareEnabled = navigator.canShare && navigator.canShare(sharePayload)

            function share(text) {
                try {
                    navigator.share({...sharePayload, text})
                } catch (e) {
                    console.error("Failed to call navigator.share", e)
                }
            }

            function wait(milliseconds) {
                return new Promise(resolve => setTimeout(resolve, milliseconds))
            }

            function node(selector) {
                return document.querySelector(selector)
            }

            function nodes(selector) {
                return Array.from(document.querySelectorAll(selector))
            }

            function resolveToArray(something) {
                if (typeof something === "string") {
                    something = nodes(something)
                }
                if (Array.isArray(something)) {
                    return something
                }
                if (something == null || typeof something !== "object") {
                    return []
                }
                return [something]
            }

            function addClass(something, className) {
                resolveToArray(something).forEach((e) => e.classList.add(className))
            }

            function removeClass(something, className) {
                resolveToArray(something).forEach((e) => e.classList.remove(className))
            }

            function getAudio() {
                return node("#jingle")
            }

            function getLabelFor(element) {
                return node(`label[for=${element.id}]`)
            }

            function showLabel(element) {
                removeClass(getLabelFor(element), "hide")
            }

            function hideLabel(element) {
                addClass(getLabelFor(element), "hide")
            }

            function showBottomSection(panelSelector) {
                addClass("#misc-panel section", "hide")
                addClass("#splash", "show-misc")
                removeClass(panelSelector, "hide")
            }

            function hideBottomSection() {
                removeClass("#splash", "show-misc")
            }

            function showNewQuote() {
                addClass("#quote-section", "show-quote")
                node("#quote-section > blockquote").innerText = quoteProvider.getAndIncrement()

                const instructions = node("#quote-section > .instructions")
                if (!instructions.classList.contains("hide")) {
                    wait(250).then(() => addClass(instructions, "hide"))
                }
            }

            function startExperience() {
                addClass(document.body, "active")
                wait(1000).then(() => addClass("#splash", "hide"))
                getAudio().play();
                if (!isLocalhost) {
                    api.incrementButtonCount()
                }
            }

            function handleAudioTimeUpdate() {
                const audioSampleTolerance = 500
                const fireworkLaunchTimeSeconds = 25
                const { currentTime } = getAudio()

                for (const [time, selector] of focusSchedule) {
                    const timeUntilFocus = (time - currentTime) * 1000
                    if (timeUntilFocus <= audioSampleTolerance) {
                        wait(timeUntilFocus).then(() => addClass(`#${selector}.word`, "focus"))
                        wait(timeUntilFocus + 1000).then(() => removeClass(`#${selector}.word`, "focus"))
                    }
                }

                if (currentTime >= fireworkLaunchTimeSeconds && nodes(".firework").length === 0) {
                    for (let i = 0; i < 7; i++) {
                        const firework = document.createElement("div")
                        addClass(firework, "firework")
                        addClass(firework, `f${i + 1}`)
                        document.body.appendChild(firework)
                    }
                }
            }

            function stopExperience() {
                removeClass(document.body, "active")
                removeClass("#splash", "hide")
                nodes('.firework').forEach(e => e.remove());
                const audio = getAudio()
                audio.pause()
                audio.currentTime = 0
            }

            addEventListener("load", () => {
                if (isLocalhost) {
                    const livejs = document.createElement("script");
                    livejs.setAttribute("src", "https://livejs.com/live.js")
                    livejs.setAttribute("type", "text/javascript")
                    document.head.appendChild(livejs)
                }

                const buttonClickHandlerMapping = {
                    "#start-button": (event, button) => {
                        startExperience()
                    },
                    "#share-button": (event, button) => {
                        share(`"${quoteProvider.get().replaceAll("\"", "'")}" - Dandy Dan`);
                        hideLabel(button)
                    },
                    "#stats-button": (event, button) => {
                        showBottomSection("#stats-section")
                        hideLabel(button)
                        api.getButtonCount().then(count => node("#odometer").innerText = `${count}`)
                    },
                    "#quotes-button": (event, button) => {
                        showBottomSection("#quote-section")
                        hideLabel(button)
                    },
                    "#faq-button": (event, button) => {
                        showBottomSection("#faq-section")
                        hideLabel(button)
                    },
                    "#about-button": (event, button) => {
                        showBottomSection("#about-section")
                        hideLabel(button)
                    },
                    "#go-back-button": (event, button) => {
                        hideBottomSection()
                    },
                    "#new-quote-button": (event, button) => {
                        showNewQuote()
                    }
                };

                for (const [buttonId, clickFunction] of Object.entries(buttonClickHandlerMapping)) {
                    const button = node(buttonId)

                    button.addEventListener("click", (event) => clickFunction(event, node(buttonId)))

                    if (getLabelFor(button) != null) {
                        button.addEventListener("pointerenter", (event) => {
                            if (event.pointerType === "mouse"){
                                showLabel(button)
                            }
                        })
                        button.addEventListener("pointerleave", (event) => {
                            if (event.pointerType === "mouse") {
                                hideLabel(button)
                            }
                        })
                    }
                }

                const audio = getAudio()
                audio.addEventListener("timeupdate", handleAudioTimeUpdate);
                audio.addEventListener("ended", stopExperience);

                if (!isShareEnabled) {
                    addClass("#share-button", "hide")
                }

                removeClass("#control-panel", "hide")
            })
        })()
    </script>
</head>
<body>
    <main id="splash" class="background-container">
        <nav id="control-panel" class="hide">
            <button id="start-button">click for dandy day</button>
            <div id="additional">
                <div id="additional-buttons">
                    <button id="share-button">share</button>
                    <button id="stats-button">count</button>
                    <button id="quotes-button">quote</button>
                    <button id="faq-button">faq</button>
                    <button id="about-button">about</button>
                </div>
                <div id="additional-info">
                    <label for="share-button" class="hide">share this site to brighten someone else's day</label>
                    <label for="stats-button" class="hide">view the total number of dandy days wished</label>
                    <label for="quotes-button" class="hide">get a fun quote from Dandy Dan himself</label>
                    <label for="faq-button" class="hide">view the frequently asked questions</label>
                    <label for="about-button" class="hide">view information about this site</label>
                </div>
            </div>
        </nav>
        <div id="misc-panel">
            <button id="go-back-button">
                <svg style="pointer-events: none;" fill="currentColor" height="800px" width="800px" viewBox="0 0 330 330">
                    <path fill="currentColor" d="M325.606,229.393l-150.004-150C172.79,76.58,168.974,75,164.996,75c-3.979,0-7.794,1.581-10.607,4.394
                    l-149.996,150c-5.858,5.858-5.858,15.355,0,21.213c5.857,5.857,15.355,5.858,21.213,0l139.39-139.393l139.397,139.393
                    C307.322,253.536,311.161,255,315,255c3.839,0,7.678-1.464,10.607-4.394C331.464,244.748,331.464,235.251,325.606,229.393z"/>
                </svg>
            </button>
            <section id="stats-section" class="hide">
                <div id="odometer" class="odometer">0</div>
                <p>number of dandy days wished</p>
            </section>
            <section id="quote-section" class="hide">
                <div class="instructions">
                    Please boop Dandy Dan on his nose.
                </div>
                <blockquote></blockquote>
                <div class="spacer"></div>
                <div id="quote-dandy-dan">
                    <img src="image/dandy-dan.png"
                         alt="A smiling man wearing a bowling hat, a rainbow plaid blazer, and a fake moustache gives two thumbs up."
                         draggable="false">
                    <button id="new-quote-button"></button>
                </div>
            </section>
            <section id="faq-section" class="hide">
                <h3>frequently asked questions</h3>

                <h6>What am I looking at?</h6>
                <p>
                    A website that wishes a dandy day to everyone who visits.
                </p>

                <h6>Why does this exist?</h6>
                <p>
                    To give you something to chuckle at.
                </p>

                <h6>Why are you trying to make me chuckle?</h6>
                <p>
                    There are already enough things on the internet to make you grumble.
                    I figured this might be a nice change of pace.
                </p>

                <h6>Out everything you could have made, why this?</h6>
                <p>
                    Because this idea made me laugh considerably more than any of my other ideas.
                </p>

                <h6>Why did this idea make you laugh so much?</h6>
                <p>
                    Very good question. I don't really know. It's just funny.
                </p>

                <h6>How much time did you spend making this?</h6>
                <p>
                    More than a little and less than a lot. But either way, probably too much.
                </p>

                <h6>Who is Dandy Dan?</h6>
                <p>
                    The dandiest man on the internet.
                </p>

                <h6>What is Dandy Dan's life story?</h6>
                <p>
                    He didn't exist for most of human history.
                    Then this website was created and he poofed into existence.
                    Now he will dance and be dandy for all of eternity.
                    That is pretty much all there is to it.
                </p>

                <h6>Where is the beautiful vista that Dandy Dan is dancing in located?</h6>
                <p>
                    In Dandyland of course.
                </p>

                <h6>Can I visit Dandyland?</h6>
                <p>
                    Within your imagination, anything is possible.
                    Within reality, probably not.
                </p>

                <h6>My day isn't that dandy. What should I do?</h6>
                <p>
                    Go experience Dandy Dan and his dandy song.
                    Maybe it will help turn your day around.
                </p>

                <h6>My day is already too dandy to handle. What should I do?</h6>
                <p>
                    Think long and hard before you experience Dandy Dan and his dandy song.
                    That much dandiness may be dangerous.
                </p>

                <h6>What am I supposed to do after I experience Dandy Dan and his dandy song?</h6>
                <p>
                    The possibilities are endless.
                </p>
                <ul>
                    <li>
                        Continue going about your day.
                    </li>
                    <li>
                        Experience it again.
                    </li>
                    <li>
                        Share it with someone else so that they can experience it.
                    </li>
                    <li>
                        Look back on your life and ponder the long chain of events
                        that have led you to the point where you are reading this FAQ.
                    </li>
                    <li>
                        All of the above.
                    </li>
                    <li>
                        None of the above.
                    </li>
                </ul>

                <h6>The dandy song is stuck in my head. What can I do?</h6>
                <p>
                    Unfortunately not much.
                    It is an especially catchy tune.
                    It will likely be cemented in your skull for the foreseeable future.
                </p>

                <h6>I dislike Dandy Dan and his dandy song. How can I express my displeasure?</h6>
                <p>
                    Follow these steps carefully:
                </p>
                <ol>
                    <li>
                        Turn your head to the sky.
                    </li>
                    <li>
                        Shake your fists in rage.
                    </li>
                    <li>
                        Howl,
                        "Curse you Dandy Dan and your dandy song!
                        I do not find you dandy!"
                    </li>
                </ol>
                <h6>I enjoy Dandy Dan and his dandy song. How can I express my pleasure?</h6>
                <p>
                    Follow these steps carefully:
                </p>
                <ol>
                    <li>
                        Turn your head to the sky.
                    </li>
                    <li>
                        Raise your hands in exaltation.
                    </li>
                    <li>
                        Rejoice and sing,
                        "Bless you Dandy Dan and your dandy song!
                        I find you oh so very dandy!"
                    </li>
                </ol>
            </section>
            <section id="about-section" class="hide">
                <p>
                    <span style="font-weight: bold">Created, designed, and developed</span>
                    by an unusually peculiar jabroni.
                </p>
                <p>
                    <span style="font-weight: bold">Original lyrics and music</span>
                    by an artistically talented non-jabroni.
                </p>
                <br/>
                <p style="font-style: italic; font-size: .85rem;">
                    This website does not use cookies and does not collect, store, or share user data
                    (other than the total number of times the big dandy button was clicked).
                </p>
            </section>
        </div>
    </main>
    <div id="sun"></div>
    <div class="cloud">
        <div></div>
    </div>
    <div class="cloud">
        <div></div>
    </div>
    <div class="cloud">
        <div></div>
    </div>
    <div id="mountain">
        <img src="image/mountain.svg"
             alt="A snowy mountain range in the background."
             draggable="false"/>
    </div>
    <div id="billboard">
        <h1 id="greeting">
            <span class="word" id="have">Have</span>
            <span class="word" id="a">A</span>
            <span class="word" id="dan">Dan</span><span class="word" id="dy">dy</span>
            <span class="word" id="day">Day!</span>
        </h1>
        <div class="bar"></div>
        <div class="legs">
            <div class="left"></div>
            <div class="right"></div>
        </div>
    </div>
    <div id="dandy-dan">
        <img src="image/dandy-dan.png"
             alt="A smiling man wearing a bowling hat, a rainbow plaid blazer, and a fake moustache gives two thumbs up."
             draggable="false"
             class="dance"/>
    </div>
    <div id="grass">
        <div class="lawn"></div>
        <div class="lawn"></div>
        <div class="lawn"></div>
        <div class="lawn"></div>
        <div class="lawn"></div>
        <div class="lawn"></div>
        <div class="lawn"></div>
        <div class="lawn"></div>
        <div class="lawn"></div>
        <div class="lawn"></div>
        <div class="lawn"></div>
        <div class="lawn"></div>
        <div class="lawn"></div>
        <div class="lawn"></div>
        <div class="lawn"></div>
        <div class="lawn"></div>
        <div class="lawn"></div>
        <div class="lawn"></div>
        <div class="lawn"></div>
        <div class="lawn"></div>
    </div>
    <div class="bg right"></div>
    <div class="bg right bg2"></div>
    <div class="bg right bg3"></div>
    <div class="bg left"></div>
    <div class="bg left bg4"></div>
    <div class="bg left bg5"></div>
    <audio id="jingle" preload="auto">
        <source src="audio/jingle.mp3" type="audio/mpeg" />
    </audio>
</body>
</html>